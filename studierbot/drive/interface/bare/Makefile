CC=g++
CFLAGS=-Wall -std=c++11 -pthread -g
INC=..

SRC_COMMON=../SerialPort.cpp ../control.cpp
HDR_COMMON=../SerialPort.h ../protocol.h ../control.h

SRC_CAN=../SocketCAN.cpp ../SocketCANObserver.cpp ../MotorControllerCAN.cpp ../AddonShieldCAN.cpp
HDR_CAN=../SocketCAN.h ../SocketCANObserver.h

#SRC_OPEN_LOOP=step_response_open_loop.cpp
#SRC_CLOSED_LOOP=step_response_closed_loop.cpp

SRC_CAN_MOTOR_TEST=can_motor_test.cpp
HDR_CAN_MOTOR=../MotorControllerCAN.h

SRC_CAN_ADDON_TEST=can_addon_test.cpp
HDR_CAN_ADDON=../AddonShieldCAN.h

#EXECUTABLE_OPEN_LOOP=$(SRC_OPEN_LOOP:.cpp=)
#EXECUTABLE_CLOSED_LOOP=$(SRC_CLOSED_LOOP:.cpp=)
EXECUTABLE_CAN_MOTOR_TEST=$(SRC_CAN_MOTOR_TEST:.cpp=)
EXECUTABLE_CAN_ADDON_TEST=$(SRC_CAN_ADDON_TEST:.cpp=)

all: $(EXECUTABLE_CAN_MOTOR_TEST) $(EXECUTABLE_CAN_ADDON_TEST)

#$(EXECUTABLE_OPEN_LOOP): $(SRC_OPEN_LOOP) $(SRC_COMMON) $(HDR_COMMON)
#	$(CC) $(CFLAGS) -I $(INC) $(SRC_OPEN_LOOP) $(SRC_COMMON) -o $@

#$(EXECUTABLE_CLOSED_LOOP): $(SRC_CLOSED_LOOP) $(SRC_COMMON) $(HDR_COMMON)
#	$(CC) $(CFLAGS) -I $(INC) $(SRC_CLOSED_LOOP) $(SRC_COMMON) -o $@

$(EXECUTABLE_CAN_MOTOR_TEST): $(SRC_CAN_MOTOR_TEST) $(SRC_CAN) $(HDR_CAN) $(HDR_CAN_MOTOR)
	$(CC) $(CFLAGS) -I $(INC) $(SRC_CAN_MOTOR_TEST) $(SRC_CAN) -o $@

$(EXECUTABLE_CAN_ADDON_TEST): $(SRC_CAN_ADDON_TEST) $(SRC_CAN) $(HDR_CAN) $(HDR_CAN_ADDON)
	$(CC) $(CFLAGS) -I $(INC) $(SRC_CAN_ADDON_TEST) $(SRC_CAN) -o $@
			
clean:
	rm $(EXECUTABLE_MOTOR_CAN_TEST) $(EXECUTABLE_ADDON_CAN_TEST)